<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns#">
  <head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="theme-color" content="#2ecc71">
<meta property="og:url" content="http://thecynicaldba.com/sql-server-2016-phones-home" />
<title> SQL Server 2016 phones home | the_cynical_dba</title>
<meta property="og:title" content=" SQL Server 2016 phones home | the_cynical_dba"/>
<meta property="og:description" name="description" content="SQL Server 2016 phones home" />
<meta name="keywords" content="DBA, SQL, Blog, MSSQL, Databases">
<link rel="stylesheet" href="/css/main.css">
<link rel="canonical" href="http://thecynicaldba.com/sql-server-2016-phones-home">
<link rel="alternate" type="application/rss+xml" title="the_cynical_dba" href="http://thecynicaldba.com/feed.xml" />
<script type='text/javascript' src='//platform-api.sharethis.com/js/sharethis.js#property=5961447a33add90011bd1e36&product=inline-share-buttons' async='async'></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-102162987-1', 'auto');
  ga('send', 'pageview');
</script>
<script>base_url = "";</script>
  </head>
  <body class="single">
    <main class="main-container">
        <header class="site-header">
  <div class="container txt-center">
    <a href="#" class="nav-toogle js-menu-trigger sliding-panel-button">
      <span></span>
      <span></span>
      <span></span>
    </a>
    <nav class="js-menu sliding-panel-content">
      <ul>
        <li><a href="/">home</a></li>
        <li><a href="/author">author</a></li>
        <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i> feed</a></li>
      </ul>
    </nav>
    <div class="js-menu-screen sliding-panel-fade-screen"></div>
      <h1 class="page-title">SQL Server 2016 phones home</h1>
      <p class="post-meta">Sep 24, 2017</p>
  </div>
</header>
        <section class="main-content">
          <article class="post">
  <div class="post-content container">
    <p>If you recently upgraded to SQL Server 2016, you may be in for a surprise when researching the new login <strong>NT SERVICE\SQLTELEMETRY</strong>. 
This login is part of a new user activity collection process that uploads directly to Microsoft. 
If this is not already concerning for you, chances are it will be for your auditors.</p>
<h2 id="we-are-broadcasting-what">“We are broadcasting what?…”</h2>
<p>Ideally, your database environment does not connect to the outside world; but if that is not the case, the last thing you need is to explain to management that “<em>Surprise! We are now broadcasting database activity logs</em>”. 
Of course, the <a href="https://support.microsoft.com/en-us/help/3153756/how-to-configure-sql-server-2016-to-send-feedback-to-microsoft">official documentation</a> clarifies that the data collected is relatively harmless, but that means little when you are required to pre-approve all external communications in order to maintain compliance. 
Fortunately, Microsoft’s usage collection can be disabled to avoid these concerns all together, or for while you await approval.</p>
<h2 id="take-it-slow">Take it slow</h2>
<p>For any paid version of SQL Server, you can disable Microsoft’s collection of your activity by opening the “SQL Server Error and Usage Reporting” application and unchecking the options to send usage and error reports. 
If auditors or management are looking for confirmation that this process is disabled, I find it convenient to send them the output of the registry values that confirm just that:</p>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">DECLARE</span> <span class="o">@</span><span class="n">RegOutput</span> <span class="k">TABLE</span> <span class="p">(</span>
        <span class="p">[</span><span class="n">Name</span><span class="p">]</span>          <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
        <span class="p">[</span><span class="n">Value</span><span class="p">]</span>         <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">@</span><span class="n">RegOutput</span>
<span class="k">EXEC</span> <span class="p">[</span><span class="n">master</span><span class="p">].[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">xp_regread</span><span class="p">]</span> <span class="o">@</span><span class="n">rootkey</span><span class="o">=</span><span class="s1">&#39;HKEY_LOCAL_MACHINE&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="k">key</span><span class="o">=</span><span class="s1">&#39;Software\Microsoft\Microsoft SQL Server\MSSQL13.&lt;instance&gt;\CPE&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;CustomerFeedback&#39;</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">@</span><span class="n">RegOutput</span>
<span class="k">EXEC</span> <span class="p">[</span><span class="n">master</span><span class="p">].[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">xp_regread</span><span class="p">]</span> <span class="o">@</span><span class="n">rootkey</span><span class="o">=</span><span class="s1">&#39;HKEY_LOCAL_MACHINE&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="k">key</span><span class="o">=</span><span class="s1">&#39;Software\Microsoft\Microsoft SQL Server\MSSQL13.&lt;instance&gt;\CPE&#39;</span><span class="p">,</span>
<span class="o">@</span><span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;EnableErrorReporting&#39;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">RegOutput</span></code></pre></div>
<p>It feels like every few weeks we learn of a newly compromised company. 
Error logs can be a critical component in assisting those that are attempting to gain unauthorized access. 
When given the option, why make it any easier for them by potentially exposing data related to your company’s internal operations?</p>
    <aside class="share">
      <div class="sharethis-inline-share-buttons"></div>
    </aside>
  </div>
  <hr>
  <aside id="comments" class="disqus">
    <div class="container">
      <h3><i class="icon icon-comments-o"></i> Comments</h3>
      <div id="disqus_thread"></div>
      <script>
          /**
           *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
           *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
           */
          //var disqus_developer = 1; // Comment out when the site is live
          var disqus_config = function () {
              this.page.url = 'http://thecynicaldba.com/sql-server-2016-phones-home';  // Replace PAGE_URL with your page's canonical URL variable
              this.page.identifier = '/sql-server-2016-phones-home'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
          };
          (function() {  // DON'T EDIT BELOW THIS LINE
              var d = document, s = d.createElement('script');
              s.src = 'https://cynical-dba.disqus.com/embed.js';
              s.setAttribute('data-timestamp', +new Date());
              (d.head || d.body).appendChild(s);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    </div>
  </aside>
</article>
        </section>
<div class="clearfix"></div>
<footer class="site-footer txt-center">
  <hr>
  <ul class="social">
  </ul>
  <svg style="position: absolute; width: 0; height: 0; overflow: hidden" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <defs>
      <symbol id="icon-mug" viewBox="0 0 32 32">
      <title>coffee</title>
      <path d="M30 10h-6v-3c0-2.761-5.373-5-12-5s-12 2.239-12 5v20c0 2.761 5.373 5 12 5s12-2.239 12-5v-3h6c1.105 0 2-0.895 2-2v-10c0-1.105-0.895-2-2-2zM5.502 8.075c-1.156-0.381-1.857-0.789-2.232-1.075 0.375-0.286 1.075-0.694 2.232-1.075 1.811-0.597 4.118-0.925 6.498-0.925s4.688 0.329 6.498 0.925c1.156 0.381 1.857 0.789 2.232 1.075-0.375 0.286-1.076 0.694-2.232 1.075-1.811 0.597-4.118 0.925-6.498 0.925s-4.688-0.329-6.498-0.925zM28 20h-4v-6h4v6z"></path>
      </symbol>
    </defs>
  </svg>
  <small>&copy; 2017. Made with <a href="http://jekyllrb.com" target="_blank">Jekyll</a> and <svg class="icon-mug"><use xlink:href="#icon-mug"></use></svg>.</small>
</footer>
    </main>
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jekyll-search.min.js"></script>
    <script src="/js/main.js"></script>
  </body>
</html>
